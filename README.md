# StreamX
let't flink|spark easy


> ä¸€ä¸ªç¥å¥‡çš„æ¡†æ¶,è®©Flinkå¼€å‘æ›´ç®€å•

## ä»€ä¹ˆæ˜¯Streamx â“
&nbsp;&nbsp;&nbsp;&nbsp;å¤§æ•°æ®æŠ€æœ¯å¦‚ä»Šå‘å±•çš„å¦‚ç«å¦‚è¼,å·²ç»å‘ˆç°æ¬£æ¬£å‘è£ç™¾èŠ±é½æ”¾çš„æ™¯è±¡,å®æ—¶å¤„ç†æµåŸŸ `Apache Spark` å’Œ `Apache Flink` æ›´æ˜¯ä¸€ä¸ªä¼Ÿå¤§çš„è¿›æ­¥,å°¤å…¶æ˜¯`Apache Flink`è¢«æ™®éè®¤ä¸ºæ˜¯ä¸‹ä¸€ä»£å¤§æ•°æ®æµè®¡ç®—å¼•æ“,æˆ‘ä»¬åœ¨ä½¿ç”¨ `Flink` æ—¶å‘ç°ä»ç¼–ç¨‹æ¨¡å‹, å¯åŠ¨é…ç½®åˆ°è¿ç»´ç®¡ç†éƒ½æœ‰å¾ˆå¤šå¯ä»¥æŠ½è±¡å…±ç”¨çš„åœ°æ–¹,
æˆ‘ä»¬å°†ä¸€äº›å¥½çš„ç»éªŒå›ºåŒ–ä¸‹æ¥å¹¶ç»“åˆä¸šå†…çš„æœ€ä½³å®è·µ, é€šè¿‡ä¸æ–­åŠªåŠ›ç»ˆäºè¯ç”Ÿäº†ä»Šå¤©çš„æ¡†æ¶ â€”â€” `StreamX`, é¡¹ç›®çš„åˆè¡·æ˜¯ â€”â€” è®© `Flink` å¼€å‘æ›´ç®€å•, ä½¿ç”¨`StreamX`å¼€å‘,å¯ä»¥æå¤§é™ä½å­¦ä¹ æˆæœ¬å’Œå¼€å‘é—¨æ§›,
è®©ä½ åªç”¨å…³å¿ƒæœ€æ ¸å¿ƒçš„ä¸šåŠ¡,`StreamX` è§„èŒƒäº†é¡¹ç›®çš„é…ç½®,é¼“åŠ±å‡½æ•°å¼ç¼–ç¨‹,å®šä¹‰äº†æœ€ä½³çš„ç¼–ç¨‹æ–¹å¼,æä¾›äº†ä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„`Connector`,æ ‡å‡†åŒ–äº†é…ç½®ã€å¼€å‘ã€æµ‹è¯•ã€éƒ¨ç½²ã€ç›‘æ§ã€è¿ç»´çš„æ•´ä¸ªè¿‡ç¨‹, æä¾›`scala`å’Œ`java`ä¸¤å¥—api,
å…¶æœ€ç»ˆç›®çš„æ˜¯æ‰“é€ ä¸€ä¸ªä¸€ç«™å¼å¤§æ•°æ®å¹³å°,æµæ‰¹ä¸€ä½“,æ¹–ä»“ä¸€ä½“çš„è§£å†³æ–¹æ¡ˆ
<video src="http://assets.streamxhub.com/streamx.mp4" controls="controls" autoplay="autoplay" width="100%" height="100%"></video>

## Features ğŸ‰ğŸ‰ğŸ‰
* å¼€å‘è„šæ‰‹æ¶
* ä»ä»»åŠ¡å¼€å‘é˜¶æ®µåˆ°éƒ¨ç½²ç®¡ç†å…¨é“¾è·¯æ”¯æŒ
* ä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„connectors
* æ”¯æŒé¡¹ç›®ç¼–è¯‘åŠŸèƒ½(maven ç¼–è¯‘)
* åœ¨çº¿å‚æ•°é…ç½®
* æ”¯æŒ`Applicaion` æ¨¡å¼, `Yarn-Per-Job`æ¨¡å¼å¯åŠ¨
* å¿«æ·çš„æ—¥å¸¸æ“ä½œ(ä»»åŠ¡`å¯åŠ¨`ã€`åœæ­¢`ã€`savepoint`,ä»`savepoint`æ¢å¤)
* æ”¯æŒç«ç„°å›¾
* æ”¯æŒ`notebook`(åœ¨çº¿ä»»åŠ¡å¼€å‘)
* é¡¹ç›®é…ç½®å’Œä¾èµ–ç‰ˆæœ¬åŒ–ç®¡ç†
* æ”¯æŒä»»åŠ¡å¤‡ä»½ã€å›æ»š(é…ç½®å›æ»š)
* åœ¨çº¿ç®¡ç†ä¾èµ–(maven pom)å’Œè‡ªå®šä¹‰jar
* è‡ªå®šä¹‰udfã€è¿æ¥å™¨ç­‰æ”¯æŒ
* Flink SQL WebIDE
* æ”¯æŒcatalogã€hive
* ***


## ç»„æˆéƒ¨åˆ†

`Streamx`æœ‰ä¸‰éƒ¨åˆ†ç»„æˆ,`streamx-core`,`streamx-pump` å’Œ `streamx-console`

### 1ï¸âƒ£ streamx-core

`streamx-core` å®šä½æ˜¯ä¸€ä¸ªå¼€å‘æ—¶æ¡†æ¶,å…³æ³¨ç¼–ç å¼€å‘,è§„èŒƒäº†é…ç½®æ–‡ä»¶,æŒ‰ç…§çº¦å®šä¼˜äºé…ç½®çš„æ–¹å¼è¿›è¡Œå¼€å‘,æä¾›äº†ä¸€ä¸ªå¼€å‘æ—¶ `RunTime Content`å’Œä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„`Connector`,æ‰©å±•äº†`DataStream`ç›¸å…³çš„æ–¹æ³•,èåˆäº†`DataStream`å’Œ`Flink sql` api,ç®€åŒ–ç¹ççš„æ“ä½œ,èšç„¦ä¸šåŠ¡æœ¬èº«,æé«˜å¼€å‘æ•ˆç‡å’Œå¼€å‘ä½“éªŒ

### 2ï¸âƒ£ streamx-pump

`pump` æ˜¯æŠ½æ°´æœº,æ°´æ³µçš„æ„æ€,`streamx-pump`çš„å®šä½æ˜¯ä¸€ä¸ªæ•°æ®æŠ½å–çš„ç»„ä»¶,ç±»ä¼¼äº`flinkx`,åŸºäº`streamx-core`ä¸­æä¾›çš„å„ç§`connector`å¼€å‘,ç›®çš„æ˜¯æ‰“é€ ä¸€ä¸ªæ–¹ä¾¿å¿«æ·,å¼€ç®±å³ç”¨çš„å¤§æ•°æ®å®æ—¶æ•°æ®æŠ½å–å’Œè¿ç§»ç»„ä»¶,å¹¶ä¸”é›†æˆåˆ°`streamx-console`ä¸­,è§£å†³å®æ—¶æ•°æ®æºè·å–é—®é¢˜,ç›®å‰åœ¨è§„åˆ’ä¸­

### 3ï¸âƒ£ streamx-console

`streamx-console` æ˜¯ä¸€ä¸ªç»¼åˆå®æ—¶æ•°æ®å¹³å°,ä½ä»£ç (`Low Code`)å¹³å°,å¯ä»¥è¾ƒå¥½çš„ç®¡ç†`Flink`ä»»åŠ¡,é›†æˆäº†é¡¹ç›®ç¼–è¯‘ã€å‘å¸ƒã€å‚æ•°é…ç½®ã€å¯åŠ¨ã€`savepoint`,ç«ç„°å›¾(`flame graph`),`Flink SQL`,ç›‘æ§ç­‰è¯¸å¤šåŠŸèƒ½äºä¸€ä½“,å¤§å¤§ç®€åŒ–äº†`Flink`ä»»åŠ¡çš„æ—¥å¸¸æ“ä½œå’Œç»´æŠ¤,èåˆäº†è¯¸å¤šæœ€ä½³å®è·µã€‚æ—§æ—¶ç‹è°¢å ‚å‰ç‡•,é£å…¥å¯»å¸¸ç™¾å§“å®¶,è®©å¤§å…¬å¸æœ‰èƒ½åŠ›ç ”å‘ä½¿ç”¨çš„é¡¹ç›®,ç°åœ¨äººäººå¯ä»¥ä½¿ç”¨,å…¶æœ€ç»ˆç›®æ ‡æ˜¯æ‰“é€ æˆä¸€ä¸ªå®æ—¶æ•°ä»“,æµæ‰¹ä¸€ä½“çš„ä¸€ç«™å¼å¤§æ•°æ®è§£å†³æ–¹æ¡ˆ
,è¯¥é¡¹ç›®æä¾›äº†ç§Ÿæˆ·å’Œæƒé™ç®¡ç†,ä»£ç é£æ ¼å……åˆ†éµå®ˆé˜¿é‡Œçš„å¼€å‘è§„èŒƒ,ç»“æ„ä¹Ÿå°½å¯èƒ½çš„æ¸…æ™°è§„èŒƒ,å¯ä»¥ä½œä¸ºå¤§æ•°æ®å¹³å°çš„å¼€å‘åŸºç¡€,å¾ˆæ–¹ä¾¿åœ°è¿›è¡ŒäºŒæ¬¡å¼€å‘,è¯¥å¹³å°ä½¿ç”¨åˆ°ä½†ä¸ä»…é™ä»¥ä¸‹æŠ€æœ¯
* [Apache Flink](http://flink.apache.org)
* [Apache YARN](http://hadoop.apache.org)
* [Spring Boot](https://spring.io/projects/spring-boot/)
* [Mybatis](http://www.mybatis.org)
* [Mybatis-Plus](http://mp.baomidou.com)
* [Flame Graph](http://www.brendangregg.com/FlameGraphs)
* [JVM-Profiler](https://github.com/uber-common/jvm-profiler)
* [Vue](https://cn.vuejs.org/)
* [VuePress](https://vuepress.vuejs.org/)
* [Ant Design of Vue](https://antdv.com/)
* [ANTD PRO VUE](https://pro.antdv)
* [xterm.js](https://xtermjs.org/)
* [Monaco Editor](https://microsoft.github.io/monaco-editor/)
* ...

æ„Ÿè°¢ä»¥ä¸Šä¼˜ç§€çš„å¼€æºé¡¹ç›®å’Œå¾ˆå¤šæœªæåˆ°çš„ä¼˜ç§€å¼€æºé¡¹ç›®,ç»™äºˆæœ€å¤§çš„respect,ç‰¹åˆ«æ„Ÿè°¢[Apache Zeppelin](http://zeppelin.apache.org)åœ¨å¼€å‘`NoteBook`æ¨¡å—æ—¶ä»ä¸­å€Ÿé‰´äº†å¤§é‡æ€æƒ³,
ç‰¹åˆ«æ„Ÿè°¢[IntelliJ IDEA](https://www.jetbrains.com/idea/), æ„Ÿè°¢[fire-spark](https://github.com/GuoNingNing/fire-spark)é¡¹ç›®,æ—©æœŸç»™äºˆçš„çµæ„Ÿå’Œå¸®åŠ©,
æ„Ÿè°¢æˆ‘è€å©†åœ¨é¡¹ç›®å¼€å‘æ—¶ç»™äºˆçš„æ”¯æŒ,æ‚‰å¿ƒç…§é¡¾æˆ‘çš„ç”Ÿæ´»å’Œæ—¥å¸¸,ç»™äºˆæˆ‘è¶³å¤Ÿçš„æ—¶é—´å¼€å‘è¿™ä¸ªé¡¹ç›®

## ä¸ºä»€ä¹ˆä¸æ˜¯...? ğŸ‘» ğŸ‘» ğŸ‘»

### Apache Zeppelin

[Apache Zeppelin](http://zeppelin.apache.org)æ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„å¼€æºé¡¹ç›®ğŸ‘ å¯¹`Flink`åšäº†å¾ˆå¥½çš„æ”¯æŒ,`Zeppelin`åˆ›æ–°å‹çš„`notebook`åŠŸèƒ½,è®©å¼€å‘è€…éå¸¸æ–¹ä¾¿çš„`On-line`ç¼–ç¨‹,å¿«æ·çš„æäº¤ä»»åŠ¡,è¯­è¨€å±‚é¢åŒæ—¶æ”¯æŒ`java`,`scala`,`python`,å›½å†…é˜¿é‡Œçš„ç« å‰‘å³°å¤§ä½¬ä¹Ÿåœ¨ç§¯ææ¨åŠ¨è¯¥é¡¹ç›®,å‘å‰‘å³°å¤§ä½¬è‡´ä»¥å´‡é«˜çš„æ•¬æ„ğŸ™ğŸ™ğŸ™,
ä½†è¯¥é¡¹ç›®ç›®å‰è²Œä¼¼æ²¡æœ‰è§£å†³é¡¹ç›®çš„ç®¡ç†å’Œè¿ç»´æ–¹é¢çš„ç—›ç‚¹,é’ˆå¯¹æ¯”è¾ƒå¤æ‚çš„é¡¹ç›®å’Œå¤§é‡çš„ä½œä¸šç®¡ç†å°±æœ‰äº›åŠ›ä¸ä»å¿ƒäº†,ä¸€èˆ¬æ¥è®²ä¸è®ºæ˜¯`DataStream`ä½œä¸šè¿˜æ˜¯`Flink SQL`ä½œä¸š,å¤§æ¦‚éƒ½ä¼šç»å†ä½œä¸šçš„`å¼€å‘é˜¶æ®µ`,`æµ‹è¯•é˜¶æ®µ`,`æ‰“åŒ…é˜¶æ®µ`,`ä¸Šä¼ æœåŠ¡å™¨é˜¶æ®µ`,`å¯åŠ¨ä»»åŠ¡é˜¶æ®µ`ç­‰è¿™äº›æ­¥éª¤,è¿™æ˜¯ä¸€ä¸ªé“¾è·¯å¾ˆé•¿çš„æ­¥éª¤,ä¸”æ•´ä¸ªè¿‡ç¨‹è€—æ—¶æ¯”è¾ƒé•¿,ä½“éªŒä¸å¥½,
å³ä½¿ä¿®æ”¹äº†ä¸€ä¸ªç¬¦å·,é¡¹ç›®æ”¹å®Œä¸Šçº¿éƒ½å¾—èµ°ä¸Šé¢çš„æµç¨‹,æˆ‘ä»¬æœŸæœ›è¿™äº›æ­¥éª¤èƒ½å¤ŸåŠ¨åŠ¨é¼ æ ‡ä¸€é”®å¼è§£å†³,è¿˜å¸Œæœ›è‡³å°‘èƒ½æœ‰ä¸€ä¸ªä»»åŠ¡åˆ—è¡¨çš„åŠŸèƒ½,èƒ½å¤Ÿæ–¹ä¾¿çš„ç®¡ç†ä»»åŠ¡,å¯ä»¥æ¸…æ¥šçš„çœ‹åˆ°å“ªäº›ä»»åŠ¡æ­£åœ¨è¿è¡Œ,å“ªäº›åœæ­¢äº†,ä»»åŠ¡çš„èµ„æºæ¶ˆè€—æƒ…å†µ,å¯ä»¥åœ¨ä»»åŠ¡åˆ—è¡¨é¡µé¢ä¸€é”®`å¯åŠ¨`æˆ–`åœæ­¢`ä»»åŠ¡,å¹¶ä¸”è‡ªåŠ¨ç®¡ç†`savePoint`,è¿™äº›é—®é¢˜ä¹Ÿæ˜¯å¼€å‘è€…å®é™…å¼€å‘ä¸­ä¼šé‡åˆ°äº†é—®é¢˜,
`streamx-console`å¾ˆå¥½çš„è§£å†³äº†è¿™äº›ç—›ç‚¹,å®šä½æ˜¯ä¸€ä¸ªä¸€ç«™å¼å®æ—¶æ•°æ®å¹³å°,å¹¶ä¸”å¼€å‘äº†æ›´å¤šä»¤äººæ¿€åŠ¨çš„åŠŸèƒ½(è¯¸å¦‚`Flink SQL WebIDE`,`ä¾èµ–éš”ç¦»`,`ä»»åŠ¡å›æ»š`,`ç«ç„°å›¾`ç­‰)

### FlinkX

[FlinkX](http://github.com/DTStack/flinkx) æ˜¯åŸºäºflinkçš„åˆ†å¸ƒå¼æ•°æ®åŒæ­¥å·¥å…·,å®ç°äº†å¤šç§å¼‚æ„æ•°æ®æºä¹‹é—´é«˜æ•ˆçš„æ•°æ®è¿ç§»,å®šä½æ¯”è¾ƒæ˜ç¡®,ä¸“é—¨ç”¨æ¥åšæ•°æ®æŠ½å–å’Œè¿ç§»,å¯ä»¥ä½œä¸ºä¸€ä¸ªæœåŠ¡ç»„ä»¶æ¥ä½¿ç”¨,`StreamX`å…³æ³¨å¼€å‘é˜¶æ®µå’Œä»»åŠ¡åæœŸçš„ç®¡ç†,å®šä½æœ‰æ‰€ä¸åŒ,`streamx-pump`æ¨¡å—ä¹Ÿåœ¨è§„åˆ™ä¸­,
è‡´åŠ›äºè§£å†³æ•°æ®æºæŠ½å–å’Œè¿ç§»,æœ€ç»ˆä¼šé›†æˆåˆ°`streamx-console`ä¸­


## å¦‚ä½•ç¼–è¯‘

æˆ‘ä»¬è¦åšçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å°†é¡¹ç›®cloneåˆ°æœ¬åœ°,æ‰§è¡Œç¼–è¯‘,åœ¨ç¼–è¯‘å‰è¯·ç¡®ä¿ä»¥ä¸‹äº‹é¡¹

* ç¡®ä¿æœ¬æœºå®‰è£…çš„JDK`1.8`åŠä»¥ä¸Šçš„ç‰ˆæœ¬
* ç¡®ä¿æœ¬æœºå·²ç»å®‰è£…äº†maven

å¦‚æœå‡†å¤‡å°±ç»ª,å°±å¯ä»¥cloneé¡¹ç›®å¹¶ä¸”æ‰§è¡Œç¼–è¯‘äº†

```bash
git clone https://github.com/Streamxhub/Streamx.git
cd Streamx
mvn clean install -DskipTests
```
é¡ºåˆ©çš„è¯å°±ä¼šçœ‹åˆ°ç¼–è¯‘æˆåŠŸ.

```log
[INFO] ------------------------------------------------------------------------
[INFO] Reactor Summary for Streamx 1.0.0:
[INFO]
[INFO] Streamx ............................................ SUCCESS [  1.882 s]
[INFO] Streamx : Common ................................... SUCCESS [ 15.700 s]
[INFO] Streamx : Flink Parent ............................. SUCCESS [  0.032 s]
[INFO] Streamx : Flink Common ............................. SUCCESS [  8.243 s]
[INFO] Streamx : Flink Core ............................... SUCCESS [ 17.332 s]
[INFO] Streamx : Flink Test ............................... SUCCESS [ 42.742 s]
[INFO] Streamx : Spark Parent ............................. SUCCESS [  0.018 s]
[INFO] Streamx : Spark Core ............................... SUCCESS [ 12.028 s]
[INFO] Streamx : Spark Test ............................... SUCCESS [  5.828 s]
[INFO] Streamx : Spark Cli ................................ SUCCESS [  0.016 s]
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  01:43 min
[INFO] Finished at: 2021-03-15T17:02:22+08:00
[INFO] ------------------------------------------------------------------------
```

ç¼–è¯‘å®Œæˆå,é¡¹ç›®ä¼šå®‰è£…åˆ°æœ¬åœ°çš„mavenä»“åº“é‡Œ,åœ¨ä½¿ç”¨æ—¶éœ€è¦å¼•å…¥pom

```xml
<dependency>
    <groupId>com.streamxhub.streamx</groupId>
    <artifactId>streamx-flink-core</artifactId>
    <version>1.0.0</version>
</dependency>
```

## å¿«é€Ÿä¸Šæ‰‹

### 1. ä»£ç å¼€å‘

ç°åœ¨è®©æˆ‘ä»¬å¿«é€Ÿä¸Šæ‰‹ä¸€ä¸ª`Streamx`åº”ç”¨

> ç¡®ä¿flinkç‰ˆæœ¬æ˜¯ 1.12.0 +

```scala

package com.your.flink.streamx

import com.streamxhub.streamx.flink.core.scala.sink.KafkaSink
import com.streamxhub.streamx.flink.core.scala.source.KafkaSource
import com.streamxhub.streamx.flink.core.scala.{FlinkStreaming, StreamingContext}
import org.apache.flink.api.scala._

object HelloStreamXApp extends FlinkStreaming {

  override def handle(): Unit = {
    //1) source
    val source = KafkaSource().getDataStream[String](topic = "hello")
      .uid("kfk_source")
      .name("kfk_source")
      .map(_.value)

    //2) println
    source.print()

    //3) sink
    KafkaSink(context).sink(source,topic = "kfk_sink")

  }

}

```

### 2. å®šä¹‰é…ç½®æ–‡ä»¶application.yml

åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸€ç³»åˆ—å¯åŠ¨ä¿¡æ¯ä»¥åŠConnectorç›¸å…³ä¿¡æ¯,å…·ä½“æ ¼å¼å¦‚ä¸‹ï¼š

```yaml
flink:
  deployment: #æ³¨æ„è¿™é‡Œçš„å‚æ•°ä¸€å®šèƒ½è¦flinkå¯åŠ¨æ”¯æŒçš„å‚æ•°(å› ä¸ºåœ¨å¯åŠ¨å‚æ•°è§£ææ—¶ä½¿ç”¨äº†ä¸¥æ ¼æ¨¡å¼,ä¸€ä¸ªä¸è¯†åˆ«ä¼šåœæ­¢è§£æ),è¯¦æƒ…å’ŒæŸ¥çœ‹flinkå®˜ç½‘,å¦åˆ™ä¼šé€ æˆæ•´ä¸ªå‚æ•°è§£æå¤±è´¥,æœ€æ˜æ˜¾çš„é—®é¢˜çš„æ‰¾ä¸åˆ°jaræ–‡ä»¶
    option:
      target: yarn-per-job              # --target <arg> (local|remote|yarn-per-job|yarn-session|run-application)
      detached:                         # -d   (If present, runs the job in detached mode)
      shutdownOnAttachedExit:           # -sae (If the job is submitted in attached mode, perform a best-effort cluster shutdown when the CLI is terminated abruptly, e.g., in response to a user interrupt, such as typing Ctrl + C.)
      zookeeperNamespace:               # -z Namespace to create the Zookeeper sub-paths  for high availability mode
      jobmanager:                       #  -m Address of the JobManager to which to connect. Use this flag to connect to a different JobManager than the one specified in the configuration. Attention: This option is respected only if the  high-availability configuration is NONE
    property:                           # see: https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html
      $internal.application.main: com.your.flink.streamx.HelloStreamXApp # main class
      yarn.application.name: FlinkHelloWorldApp
      yarn.application.node-label: StreamX
      taskmanager.numberOfTaskSlots: 1
      parallelism.default: 2
      jobmanager.memory:
        flink.size:
        heap.size:
        jvm-metaspace.size:
        jvm-overhead.max:
        off-heap.size:
        process.size:
      taskmanager.memory:
        flink.size:
        framework.heap.size:
        framework.off-heap.size:
        managed.size:
        process.size:
        task.heap.size:
        task.off-heap.size:
        jvm-metaspace.size:
        jvm-overhead.max:
        jvm-overhead.min:
        managed.fraction: 0.4
  checkpoints:
    enable: true
    interval: 30000
    mode: EXACTLY_ONCE
    timeout: 300000
    unaligned: true
  watermark:
    interval: 10000
  # çŠ¶æ€åç«¯
  state:
    backend: # see https://ci.apache.org/projects/flink/flink-docs-release-1.12/ops/state/state_backends.html
      value: filesystem # ä¿å­˜ç±»å‹('jobmanager', 'filesystem', 'rocksdb')
      memory: 5242880 # é’ˆå¯¹jobmanageræœ‰æ•ˆ,æœ€å¤§å†…å­˜
      async: false    # é’ˆå¯¹(jobmanager,filesystem)æœ‰æ•ˆ,æ˜¯å¦å¼€å¯å¼‚æ­¥
      incremental: true #é’ˆå¯¹rocksdbæœ‰æ•ˆ,æ˜¯å¦å¼€å¯å¢é‡
      #rocksdb çš„é…ç½®å‚è€ƒ https://ci.apache.org/projects/flink/flink-docs-release-1.12/deployment/config.html#rocksdb-state-backend
      #rocksdbé…ç½®keyçš„å‰ç¼€å»æ‰:state.backend
      #rocksdb.block.blocksize:
    checkpoints.dir: file:///tmp/chkdir
    savepoints.dir: file:///tmp/chkdir
  # é‡å¯ç­–ç•¥
  restart-strategy:
    value: fixed-delay  #é‡å¯ç­–ç•¥[(fixed-delay|failure-rate|none)å…±3ä¸ªå¯é…ç½®çš„ç­–ç•¥]
    fixed-delay:
      attempts: 3
      delay: 5000
    failure-rate:
      max-failures-per-interval:
      failure-rate-interval:
      delay:
  # table
  table:
    planner: blink # (blink|old|any)
    mode: streaming #(batch|streaming)

# source config....
kafka.source:
  bootstrap.servers: kafka1:9092,kafka2:9092,kafka3:9092
  topic: topic1,topic2,topic3
  group.id: hello
  auto.offset.reset: earliest
  #enable.auto.commit: true
  #start.from:
    #timestamp: 1591286400000 #æŒ‡å®štimestamp,é’ˆå¯¹æ‰€æœ‰çš„topicç”Ÿæ•ˆ
    #offset: # ç»™æ¯ä¸ªtopicçš„partitionæŒ‡å®šoffset
      #topic: topic1,topic2,topic3
      #topic1: 0:182,1:183,2:182 #åˆ†åŒº0ä»182å¼€å§‹æ¶ˆè´¹,åˆ†åŒº1ä»183...
      #topic2: 0:182,1:183,2:182
      #topic3: 0:192,1:196,2:196

kafka.sink:
  bootstrap.servers: kafka1:9092,kafka2:9092,kafka3:9092
  topic: kfk_sink
  transaction.timeout.ms: 1000
  semantic: AT_LEAST_ONCE # EXACTLY_ONCE|AT_LEAST_ONCE|NONE
  batch.size: 1

```

### 3. è¿è¡Œç¨‹åº

å¯åŠ¨mainæ–¹æ³•,å¹¶ä¸”è·Ÿä¸Šå‚æ•°" --flink.conf $path/application.yml"

## å®‰è£…streamx-console

> streamx-console æ˜¯ä¸€ä¸ªç»¼åˆå®æ—¶æ•°æ®å¹³å°,ä½ä»£ç (Low Code),Flink Sqlå¹³å°,å¯ä»¥è¾ƒå¥½çš„ç®¡ç†Flinkä»»åŠ¡,é›†æˆäº†é¡¹ç›®ç¼–è¯‘ã€å‘å¸ƒã€å‚æ•°é…ç½®ã€å¯åŠ¨ã€savepoint,ç«ç„°å›¾(flame graph),Flink SQL,ç›‘æ§ç­‰è¯¸å¤šåŠŸèƒ½äºä¸€ä½“,å¤§å¤§ç®€åŒ–äº†Flinkä»»åŠ¡çš„æ—¥å¸¸æ“ä½œå’Œç»´æŠ¤,èåˆäº†è¯¸å¤šæœ€ä½³å®è·µã€‚å…¶æœ€ç»ˆç›®æ ‡æ˜¯æ‰“é€ æˆä¸€ä¸ªå®æ—¶æ•°ä»“,æµæ‰¹ä¸€ä½“çš„ä¸€ç«™å¼å¤§æ•°æ®è§£å†³æ–¹æ¡ˆ

## å¦‚ä½•å®‰è£…

streamx-console æä¾›äº†å¼€ç®±å³ç”¨çš„å®‰è£…åŒ…,å®‰è£…ä¹‹å‰å¯¹ç¯å¢ƒæœ‰äº›è¦æ±‚,å…·ä½“è¦æ±‚å¦‚ä¸‹

### ç¯å¢ƒ

* æ“ä½œç³»ç»Ÿ	Linux(ä¸æ”¯æŒWindowç³»ç»Ÿ)
* JAVA	    1.8+
* MySQL	    5.6+
* Hadoop 	2+ (HDFS,YARNç­‰å¿…é¡»å®‰è£…,å¹¶ä¸”é…ç½®å¥½ç›¸å…³ç¯å¢ƒå˜é‡)
* Flink	    1.12.0+ (ç‰ˆæœ¬å¿…é¡»æ˜¯1.12.0æˆ–ä»¥ä¸Šç‰ˆæœ¬,å¹¶ä¸”é…ç½®å¥½Flinkç›¸å…³ç¯å¢ƒå˜é‡)
* Python    2+ (éå¿…é¡»,ç«ç„°å›¾åŠŸèƒ½ä¼šç”¨åˆ°Python)
* Perl  o

### å®‰è£…

åœ¨å®‰è£…å‰ä¸€å®šè¦ç¡®ä¿å½“å‰éƒ¨ç½²çš„æœºå™¨æ»¡è¶³ä¸Šé¢ç¯å¢ƒç›¸å…³çš„è¦æ±‚,å½“å‰å®‰è£…çš„æœºå™¨å¿…é¡»è¦æœ‰Hadoopç¯å¢ƒ,å®‰è£…å¹¶é…ç½®å¥½äº†[Flink 1.12.0+](https://www.apache.org/dyn/closer.lua/flink/flink-1.12.0/flink-1.12.0-bin-scala_2.11.tgz),å¦‚æœå‡†å¤‡å·¥ä½œéƒ½å·²å°±ç»ª,å°±å¯ä»¥æŒ‰ç…§äº†,ç‚¹å‡»[è¿™é‡Œ]()ä¸‹è½½streamx-consoleå®‰è£…åŒ…,è§£åŒ…åå®‰è£…ç›®å½•å¦‚ä¸‹

```textmate 
.
streamx-console-service-1.0.0
â”œâ”€â”€ bin
â”‚    â”œâ”€â”€ flame-graph
â”‚    â”œâ”€â”€   â””â”€â”€ *.py                             //ç«ç„°å›¾ç›¸å…³åŠŸèƒ½è„šæœ¬(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”‚    â”œâ”€â”€ startup.sh                             //å¯åŠ¨è„šæœ¬  
â”‚    â”œâ”€â”€ setclasspath.sh                        //javaç¯å¢ƒå˜é‡ç›¸å…³çš„è„šæœ¬(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”‚    â”œâ”€â”€ shutdown.sh                            //åœæ­¢è„šæœ¬
â”‚    â”œâ”€â”€ yaml.sh                                //å†…éƒ¨ä½¿ç”¨è§£æyamlå‚æ•°çš„è„šæœ¬(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”œâ”€â”€ conf                           
â”‚    â”œâ”€â”€ application.yaml                       //é¡¹ç›®çš„é…ç½®æ–‡ä»¶(æ³¨æ„ä¸è¦æ”¹åŠ¨åç§°)
â”‚    â”œâ”€â”€ application-prod.yml                   //é¡¹ç›®çš„é…ç½®æ–‡ä»¶(å¼€å‘è€…éƒ¨ç½²éœ€è¦æ”¹åŠ¨çš„æ–‡ä»¶,æ³¨æ„ä¸è¦æ”¹åŠ¨åç§°)
â”‚    â”œâ”€â”€ flink-application.template             //flinké…ç½®æ¨¡æ¿(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”‚    â”œâ”€â”€ logback-spring.xml                     //logback
â”‚    â”œâ”€â”€ streamx-console.sql                    //å·¥ç¨‹åˆå§‹åŒ–è„šæœ¬
â”‚    â””â”€â”€ ...
â”œâ”€â”€ lib
â”‚    â””â”€â”€ *.jar                                  //é¡¹ç›®çš„jaråŒ…
â”œâ”€â”€ plugins   
â”‚    â”œâ”€â”€ streamx-jvm-profiler-1.0.0.jar         //jvm-profiler,ç«ç„°å›¾ç›¸å…³åŠŸèƒ½(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”‚    â””â”€â”€ streamx-flink-sqlcli-1.0.0.jar         //Flink SQlæäº¤ç›¸å…³åŠŸèƒ½(å†…éƒ¨ä½¿ç”¨,ç”¨æˆ·æ— éœ€å…³æ³¨)
â”œâ”€â”€ logs                                        //ç¨‹åºlogç›®å½•
â””â”€â”€ temp                                        //å†…éƒ¨ä½¿ç”¨åˆ°çš„é›¶æ—¶è·¯å¾„,ä¸è¦åˆ é™¤
```

#### 1.åˆå§‹åŒ–å·¥ç¨‹SQL

streamx-consoleè¦æ±‚çš„æ•°æ®åº“æ˜¯MySQL,ç‰ˆæœ¬5.6+ä»¥ä¸Š,å¦‚å‡†å¤‡å°±ç»ªåˆ™è¿›è¡Œä¸‹é¢çš„æ“ä½œ:

* åˆ›å»ºæ•°æ®åº“:`streamx`
* æ‰§è¡Œåˆå§‹åŒ–sql (è§£åŒ…åçš„`conf/streamx-console.sql`)

#### 2.ä¿®æ”¹ç›¸å…³çš„æ•°æ®åº“ä¿¡æ¯

å·¥ç¨‹SQLåˆå§‹åŒ–å®Œæ¯•,åˆ™ä¿®æ”¹`conf/application-prod.yml`,æ‰¾åˆ°datasourceè¿™ä¸€é¡¹,æ‰¾åˆ°mysqlçš„é…ç½®,ä¿®æ”¹æˆå¯¹åº”çš„ä¿¡æ¯å³å¯,å¦‚ä¸‹

```yaml
  datasource:
    dynamic:
      # æ˜¯å¦å¼€å¯ SQLæ—¥å¿—è¾“å‡ºï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­ï¼Œæœ‰æ€§èƒ½æŸè€—
      p6spy: true
      hikari:
        connection-timeout: 30000
        max-lifetime: 1800000
        max-pool-size: 15
        min-idle: 5
        connection-test-query: select 1
        pool-name: HikariCP-DS-POOL
      # é…ç½®é»˜è®¤æ•°æ®æº
      primary: primary
      datasource:
        # æ•°æ®æº-1ï¼Œåç§°ä¸º primary
        primary:
          username: $user
          password: $password
          driver-class-name: com.mysql.cj.jdbc.Driver
          url: jdbc:mysql://$host:$port/streamx?useUnicode=true&characterEncoding=UTF-8&useJDBCCompliantTimezoneShift=true&useLegacyDatetimeCode=false&serverTimezone=GMT%2B8
```

#### 3.å¯åŠ¨streamx-console

è¿›å…¥åˆ°`bin`ä¸‹ç›´æ¥æ‰§è¡Œstart.shå³å¯å¯åŠ¨é¡¹ç›®,é»˜è®¤ç«¯å£æ˜¯ 10000,å¦‚æœæ²¡å•¥æ„å¤–åˆ™ä¼šå¯åŠ¨æˆåŠŸ

```bash
cd streamx-console-service-1.0.0/bin
bash start.sh
```
ç›¸å…³çš„æ—¥å¿—ä¼šè¾“å‡ºåˆ° streamx-console-service-1.0.0/logs/streamx.out é‡Œ

æ‰“å¼€æµè§ˆå™¨ è¾“å…¥ http://$deploy_host:10000/index.html å³å¯ç™»å½•,ç™»å½•ç•Œé¢å¦‚ä¸‹

<img src="http://assets.streamxhub.com/1617875805692.jpg"/>

é»˜è®¤å¯†ç : <strong> admin / streamx </strong>

## å¦‚ä½•ä½¿ç”¨

streamx-consoleå®šä½æ˜¯æµæ‰¹ä¸€ä½“çš„å¤§æ•°æ®å¹³å°,ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ,ä½¿ç”¨èµ·æ¥éå¸¸ç®€å•,æ²¡æœ‰å¤æ‚çš„æ¦‚å¿µå’Œç¹ççš„æ“ä½œ,æ ‡å‡†çš„Flinkç¨‹åº(å®‰è£…Flinkå®˜æ–¹è¦å»çš„ç»“æ„å’Œè§„èŒƒ)å’Œç”¨`streamx`å¼€å‘çš„é¡¹ç›®éƒ½åšäº†å¾ˆå¥½çš„æ”¯æŒ,ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨`streamx-quickstart`æ¥å¿«é€Ÿå¼€å¯streamx-consoleä¹‹æ—…

`streamx-quickstart`æ˜¯StreamX å¼€å‘Flinkçš„ä¸Šæ‰‹ç¤ºä¾‹ç¨‹åº,å…·ä½“è¯·æŸ¥é˜…[è¿™é‡Œ](https://github.com/streamxhub/streamx-quickstart.git)

* Github: [https://github.com/streamxhub/streamx-quickstart.git](https://github.com/streamxhub/streamx-quickstart.git)
* Gitee: [https://gitee.com/benjobs/streamx-quickstart.git](https://gitee.com/benjobs/streamx-quickstart.git)

<video src="http://assets.streamxhub.com/20210408008.mp4" controls="controls" width="100%" height="100%"></video>

å¦‚æœæ‚¨è§‰å¾—è¿˜ä¸é”™è¯·åœ¨å³ä¸Šè§’ç‚¹ä¸€ä¸‹star,å¸®å¿™è½¬å‘,è°¢è°¢ ğŸ™ğŸ™ğŸ™ å¤§å®¶çš„æ”¯æŒæ˜¯å¼€æºæœ€å¤§åŠ¨åŠ›

`Streamx`å·²æ­£å¼å¼€æº,ä¼šè¿›å…¥é«˜é€Ÿå‘å±•æ¨¡å¼,æ›´å¤šå¼€å‘ç›¸å…³ä¿¡æ¯è¯·è®¿é—®[å®˜ç½‘](http://www.streamxhub.com/#/)
